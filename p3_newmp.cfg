title Problem 3 (Van der pol)
description x'' = a(x^2-1)x' + x
parameter a    -2.0  1.0   2.0 0
parameter x0   -2.0  1.0   2.0 0
parameter xp0  -2.0  1.0   2.0 0
parameter tn    0.0  1.0  20.0 0
parameter dt    0.01 0.05  1.0 0
parameter n     1.0  5.0  10.0 1
parameter prec 16.0 64.0 128.0 16

run make -s solve_p3_mp
run rm -f out.dat t.png x.png
run ./solve_p3_mp $a $x0 $xp0 $tn $dt $n $prec

file data out.dat

profile red hex #FF0000 weight 1 solid
profile green hex #00FF00 weight 1 solid
profile blue hex #0000FF weight 2 dashed

plot xaxis num [::] t yaxis num [0::10] x
series data 1:2 title notitle profile red

error rel data 2:3 to data 2:1 profile red

plot xaxis num [::] x yaxis num [::] xprime
series data 2:3 title x_vs_xprime profile blue


